@using _23050370_Suyog_Sigdel.Services
@using Microsoft.Data.Sqlite
@inherits LayoutComponentBase
@inject ThemeService ThemeService

<div class="main-layout @ThemeClass">
    <Navbar />
    <div class="content">
        @Body
    </div>
</div>

@code {
    private string ThemeClass => ThemeService.IsDark ? "dark" : "light";

    protected override void OnInitialized()
    {
        ThemeService.OnThemeChanged += StateHasChanged;
    }

    protected override async Task OnInitializedAsync()
    {
        try
        {
            // SQLite database path
            var dbPath = Path.Combine(FileSystem.AppDataDirectory, "journals.db");
            Console.WriteLine($"SQLite DB Path: {dbPath}");

            // Open a test connection
            using var connection = new SqliteConnection($"Data Source={dbPath}");
            await connection.OpenAsync();
            Console.WriteLine("✅ Connected to SQLite successfully!");
            await connection.CloseAsync();
        }
        catch (Exception ex)
        {
            Console.WriteLine("❌ SQLite connection failed:");
            Console.WriteLine(ex.Message);
        }
    }
}